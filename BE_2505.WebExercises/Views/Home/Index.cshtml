@model List<BE_2505.WebExercises.Models.Product_Category>
@{
    ViewBag.Title = "Home Page";
}


<h2>@ViewBag.Title</h2>
<div>
    <div>
        <input id="search-text" type="text" />
        <button type="button" class="btn btn-primary search" id="btn-search">Tìm kiếm sản phẩm</button>
    </div>
    <div class="text-center">
        <button class="btn btn-success create">Create</button>
    </div>
</div>


<table class="table">
    <thead>
        <tr>
            <th>CategoryID</th>
            <th>CategoryName</th>
            <th>IsActive</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @if (Model != null && Model.Count > 0)
        {
            foreach (var item in Model)
            {
                <tr>
                    <td>@item.CategoryID</td>
                    <td>@item.CategoryName</td>
                    <td>@item.IsActive</td>
                    @*<td>
                        <button class="btn btn-info edit" data-id="@item.Id">Edit</button>
                        <button class="btn btn-danger delete" data-id="@item.Id">Delete</button>
                    </td>*@
                </tr>
            }
        }

    </tbody>
</table>

<div id="modal-form" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title"></h4>
            </div>
            <div class="modal-body">
                <form id="form-product" method="post" action="#">
                    <div class="form-group">
                        <label for="CategoryName">CategoryName</label>
                        <textarea class="form-control" id="CategoryName" name="CategoryName" placeholder="Enter CategoryName"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="btn-save">Save</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>
    <script>
        $(document).ready(function () {
            // Create product
            $(document).on('click', '.create', function () {
                $('#modal-form').modal('show');
                $('.modal-title').text('Create Product');
                $('#btn-save').attr('data-action', '@Url.Action("Create", "Home")');
                $('#form-product').trigger('reset');
            });

        // Save product
        $(document).on('click', '#btn-save', function () {
            var form = $('#form-product');
            $.post($(this).attr('data-action'), form.serialize())
                .done(function (response) {
                    if (response.success) {
                        location.reload();
                    } else {
                        alert(response.message);
                    }
                })
                .fail(function (error) {
                    console.log(error);
                });
            });
        });
        // search product
        $(document).on('click', '.search', function () {
            var search = $("#search-text").val();
            $.post('@Url.Action("Search", "Home")', { search: search })
                .done(function (response) {
                    if (response.success) {
                        $('.table').html(JSON.stringify(response.data));
                    } else {
                        alert(response.message);
                    }
                })
.               fail(function (error) {
                    console.log(error);
                });
        });
    </script>
}